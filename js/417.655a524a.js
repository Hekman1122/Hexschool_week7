"use strict";(self["webpackChunkhexschoolweek7"]=self["webpackChunkhexschoolweek7"]||[]).push([[417],{4417:function(e,t,s){s.r(t),s.d(t,{default:function(){return ke}});var o=s(6252),a=s(3577);const l={class:"container text-center"},d=(0,o._)("h2",null,"訂單列表",-1),i={class:"table table-hover"},n=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",{scope:"col"},"購買人"),(0,o._)("th",{scope:"col"},"購買時間"),(0,o._)("th",{scope:"col"},"訂單金額"),(0,o._)("th",{scope:"col"},"是否付款"),(0,o._)("th",{scope:"col"},"檢視細節"),(0,o._)("th",{scope:"col"},"編輯")])],-1),c={scope:"row"},r={scope:"row"},p={scope:"row"},h={scope:"row"},u={key:0,class:"text-success"},m={key:1,class:"text-danger"},_={scope:"row"},g=["onClick"],w={scope:"row"},b=["onClick"],k=(0,o.Uk)(" / "),f=["onClick"];function $(e,t,s,$,x,y){const M=(0,o.up)("pagination"),v=(0,o.up)("deleteModal"),z=(0,o.up)("orderModal");return(0,o.wg)(),(0,o.iD)("div",l,[d,(0,o._)("table",i,[n,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(x.orders,((e,t)=>((0,o.wg)(),(0,o.iD)("tr",{key:t},[(0,o._)("th",c,(0,a.zw)(e.user.name),1),(0,o._)("td",r,(0,a.zw)(new Date(1e3*e.create_at).toLocaleDateString()),1),(0,o._)("td",p,(0,a.zw)(e.total),1),(0,o._)("td",h,[e.is_paid?((0,o.wg)(),(0,o.iD)("span",u,"已付款")):((0,o.wg)(),(0,o.iD)("span",m,"未付款"))]),(0,o._)("td",_,[(0,o._)("button",{type:"button",class:"btn btn-outline-dark",onClick:t=>y.openOrderModal(e)},"查看",8,g)]),(0,o._)("td",w,[(0,o._)("button",{type:"button",class:"btn btn-outline-dark",onClick:t=>y.changePaidStatus(e)},"變更狀態",8,b),k,(0,o._)("button",{type:"button",class:"btn btn-outline-dark",onClick:t=>y.openDeleModal(e)},"刪除訂單",8,f)])])))),128))])]),(0,o.Wm)(M,{pages:x.pagination,onChangePage:y.getOrders},null,8,["pages","onChangePage"]),(0,o.Wm)(v,{target:x.temp,ref:"delModal",onDelItem:y.deleteOrder},null,8,["target","onDelItem"]),(0,o.Wm)(z,{ref:"orderModal",target:x.temp,onEmitUpdate:y.changePaidStatus},null,8,["target","onEmitUpdate"])])}var x=s(8004),y=s(9121);const M={class:"modal fade",id:"editModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},v={class:"modal-dialog modal-xl modal-dialog-centered"},z={class:"modal-content"},D=(0,o._)("div",{class:"modal-header"},[(0,o._)("h5",{class:"modal-title",id:"exampleModalLabel"},"詳細訂單資訊"),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),C={class:"modal-body"},U={class:"row d-flex justify-content-center mb-3"},O={class:"col-4"},S=(0,o._)("h4",{class:"text-center text-success"},"訂購人資訊",-1),P={key:0,class:"list-group text-start"},L={class:"list-group-item"},Z=(0,o._)("span",{class:"fw-bold me-3"},"姓名 : ",-1),A={class:"list-group-item"},W=(0,o._)("span",{class:"fw-bold me-3"},"電話 : ",-1),j={class:"list-group-item"},q=(0,o._)("span",{class:"fw-bold me-3"},"地址 : ",-1),E={class:"list-group-item"},H=(0,o._)("span",{class:"fw-bold me-3"},"信箱 : ",-1),I={class:"col-4"},K=(0,o._)("h4",{class:"text-center text-success"},"訂單狀態",-1),Y={class:"list-group text-start"},B={class:"list-group-item"},F=(0,o._)("span",{class:"fw-bold me-3"},"訂單編號: ",-1),G={class:"list-group-item"},J=(0,o._)("span",{class:"fw-bold me-3"},"下定日期: ",-1),N={class:"list-group-item"},Q=(0,o._)("span",{class:"fw-bold me-3"},"訂單金額: ",-1),R={class:"list-group-item"},T=(0,o._)("span",{class:"fw-bold me-3"},"付款狀態:",-1),V={key:0,class:"text-success"},X={key:1,class:"text-danger"},ee={class:"table table-hover"},te=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",{scope:"col"},"產品品名"),(0,o._)("th",{scope:"col"},"產品單價"),(0,o._)("th",{scope:"col"},"訂購數量"),(0,o._)("th",{scope:"col"},"總價")])],-1),se={scope:"row"},oe={scope:"row"},ae={scope:"row"},le={scope:"row"},de={class:"text-end"},ie=(0,o._)("span",{class:"text-success fw-bold me-3"},"訂單總金額 : ",-1),ne={class:"modal-footer"},ce=(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function re(e,t,s,l,d,i){return(0,o.wg)(),(0,o.iD)("div",M,[(0,o._)("div",v,[(0,o._)("div",z,[D,(0,o._)("div",C,[(0,o._)("div",U,[(0,o._)("div",O,[S,d.temp.user?((0,o.wg)(),(0,o.iD)("ul",P,[(0,o._)("li",L,[Z,(0,o.Uk)(" "+(0,a.zw)(d.temp.user.name),1)]),(0,o._)("li",A,[W,(0,o.Uk)(" "+(0,a.zw)(d.temp.user.tel),1)]),(0,o._)("li",j,[q,(0,o.Uk)(" "+(0,a.zw)(d.temp.user.address),1)]),(0,o._)("li",E,[H,(0,o.Uk)(" "+(0,a.zw)(d.temp.user.email),1)])])):(0,o.kq)("",!0)]),(0,o._)("div",I,[K,(0,o._)("ul",Y,[(0,o._)("li",B,[F,(0,o.Uk)(" "+(0,a.zw)(d.temp.id),1)]),(0,o._)("li",G,[J,(0,o.Uk)((0,a.zw)(new Date(1e3*d.temp.created_date).toLocaleDateString()),1)]),(0,o._)("li",N,[Q,(0,o.Uk)((0,a.zw)(d.temp.total),1)]),(0,o._)("li",R,[T,d.temp.is_paid?((0,o.wg)(),(0,o.iD)("span",V,"已付款")):((0,o.wg)(),(0,o.iD)("span",X,"未付款"))])])])]),(0,o._)("table",ee,[te,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(d.temp.products,(e=>((0,o.wg)(),(0,o.iD)("tr",{key:e.id},[(0,o._)("th",se,(0,a.zw)(e.product.title),1),(0,o._)("td",oe,(0,a.zw)(e.product.price),1),(0,o._)("td",ae,(0,a.zw)(e.qty)+" "+(0,a.zw)(e.product.unit),1),(0,o._)("td",le,(0,a.zw)(e.total)+"元",1)])))),128))])]),(0,o._)("h5",de,[ie,(0,o.Uk)(" "+(0,a.zw)(d.temp.total)+"元",1)])]),(0,o._)("div",ne,[ce,(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=t=>e.$emit("emit-update",d.temp))},"變更訂單狀態")])])])],512)}var pe=s(7424),he=s.n(pe),ue={data(){return{modal:"",temp:{}}},props:{target:{type:Object,default(){return{}}}},watch:{target(){this.temp={...this.target}}},emits:["emit-update"],methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(he())(this.$refs.modal)}},me=s(3744);const _e=(0,me.Z)(ue,[["render",re]]);var ge=_e,we={data(){return{orders:[],pagination:{},temp:{}}},components:{pagination:x.Z,deleteModal:y.Z,orderModal:ge},methods:{getOrders(e=1){const t=document.cookie.replace(/(?:(?:^|.*;\s*)hexSchool\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=`${t}`;const s="https://vue3-course-api.hexschool.io/v2",o="hexschoolforhenrywu";this.$http.get(`${s}/api/${o}/admin/orders?page=${e}`).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination})).catch((e=>{console.dir(e.response.data)}))},openDeleModal(e){this.temp={...e};const t=this.$refs.delModal;t.openModal()},openOrderModal(e){this.temp={...e};const t=this.$refs.orderModal;t.openModal()},deleteOrder(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)hexSchool\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=`${e}`;const t=this.$refs.delModal,s="https://vue3-course-api.hexschool.io/v2",o="hexschoolforhenrywu";this.$http.delete(`${s}/api/${o}/admin/order/${this.temp.id}`).then((e=>{alert("成功將訂單刪除"),this.getOrders(this.pagination.current_page),t.hideModal()})).catch((e=>{console.dir(e.response.data),t.hideModal()}))},changePaidStatus(e){const t=document.cookie.replace(/(?:(?:^|.*;\s*)hexSchool\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=`${t}`;const s=this.$refs.orderModal,o="https://vue3-course-api.hexschool.io/v2",a="hexschoolforhenrywu",l={is_paid:!e.is_paid};this.$http.put(`${o}/api/${a}/admin/order/${e.id}`,{data:l}).then((e=>{alert("成功修改訂單狀態!"),this.getOrders(this.pagination.current_page),s.hideModal()})).catch((e=>{console.dir(e.response.data),s.hideModal()}))}},mounted(){this.getOrders()}};const be=(0,me.Z)(we,[["render",$]]);var ke=be}}]);
//# sourceMappingURL=417.655a524a.js.map